## 基础运维笔记-->路由器

### 配置文件状态

路由器有两种配置状态，一种是保存在硬盘，一种是保存在内存

- startup-config
- running-config

可以在特权模式(#)下使用"show"查看

从running到startup的转换需要进行保存，在特权模式下"write"

### 恢复出厂设置

配置寄存器的两种状态，在特权模式下"show version"最后一行有显示当前寄存器状态

- 0x2102：当前正在运行的配置
- 0x2142：空配置

在路由器启动时候按ctrl+break或ctrl+c进入rommon模式，在此模式下使用"confreg"切换到0x2142后"reset"重启即可恢复出厂。

### 密码设置

全局模式(config t)下使用"enable secret"设置非明文密码

全局模式(config t)下使用"no enable secret"取消设置非明文密码

### 路由表与接口表

特权模式(#)下使用"show ip route"查看路由表，其他模式下使用"do show ip route"

特权模式(#)下使用"show ip interface"查看接口状态，其他模式下使用"do show ip interface"

特权模式(#)下使用"show ip route"后加端口，查看该端口详细路由信息。distance为管理距离优先级，直连为0，静态为1，其他根据协议有固定值。metric为路径开销，直连和静态固定0，动态不固定。

### 静态路由配置

全局模式(config t)下"ip route"加要连接的网段，加要连接的网段的子网掩码，加要经过的端口的ip地址或直接写端口（位于本路由器上的）。可以添加静态路由。

注：此配置必须双向配置，否则数据包只去不回。

全局模式(config t)下"no ip route"加要连接的网段，加要连接的网段的子网掩码，加要经过的端口的ip地址。可以去除一条特定的静态路由。

全局模式(config t)下"ip route"加0.0.0.0，加0.0.0.0，加要经过的端口的ip地址或直接写端口（位于本路由器上的）。可以添加默认路由，如果没有路由配置数据包默认送往汇总的端口。

全局模式(config t)下"ip route"加要汇总的网络地址，加要汇总的网络地址的子网掩码，加要经过的端口的ip地址或直接写端口（位于本路由器上的）。可以添加汇总路由，在此汇总地址网段内的数据包会全部送往汇总的端口。

全局模式(config t)下"ip route"加要连接的网段，加要连接的网段的子网掩码，加"null 0"。可以添加黑洞路由，要送往此网段的数据包会丢弃，多用于防环。