## linux运维笔记-->shell

无需解释

### 全局配置文件

加载系统变量共享给所有shell程序使用

1. 文件位于：

	- /etc/profile  登录了的账户可用变量

	- /etc/profile.d/*.sh

	- /etc/bashrc  所有账户可用变量

	- ...

2. 查看环境变量命令

	```bash
	# 查看系统变量
	env
	# 查看系统变量+函数+自定义变量
	set
	
3. 常用环境变量

   | 变量     | 用处                                                  |
   | -------- | ----------------------------------------------------- |
   | HOME     | 当前用户主目录                                        |
   | PATH     | 设置搜索路径，和windows的一样                         |
   | SHELL    | 当前shell解析使用哪一个解析器                         |
   | HISTFILE | 显示当前用户执行命令的历史列表文件/root/.bash_history |
   | PWD      | 显示当前所在路径                                      |
   | OLDPWD   | 显示之前路径                                          |
   | HOSTNAME | 显示当前主机名                                        |
   | HOSTTYPE | 显示主机的架构                                        |
   | LANG     | 设置当前系统语言环境                                  |

4. 重载环境变量

   ```bash
   source 绝对路径+文件名
   # 如
   source /etc/profile
   ```

   

### 局部变量的增删查

可以在本shell内访问到

```bash
# 新建，第二个为不可修改的变量
变量名=值
readonly 变量名=值
# 查找
${变量名}
# 删除
unset 变量名
```

### 全局变量的增删查

可以在本shell和子shell内访问到（本shell里面还可以bash一个脚本，这个脚本叫子shell）

```bash
#新建
export 变量名1 变量名2 ...
```

### 特殊变量

```bash
#用于脚本文件执行时传入的参数
${n}
${1}~${9} #获取输入第一到第九个输入的参数，一到九可以不带花括号
${0} #获取当前脚本的名称
```

```bash
#获取所有输入参数的个数
${#}
```

```bash
#不用双引号括起来，获取所有输入参数，用于以后输出所有参数
$* $@ #结果一样为$1 $2 $3 ...
#用双引号括起来的获取所有参数，用于以后输出所有参数
"$*" #参数拼接为一个字符串为"$1 $2 $3 ..."
"$@" #参数不拼接，单独成字符串为"$1" "$2" "$3" ...
```

```bash
#用于获取上一个shell命令的退出状态码，或者是函数的返回值（shell命令都有返回值）
$?
```

```bash
#用于获取当前shell环境的进程id号
$$
```

```bash
<& #输入重定向到文件描述符
>& #输出重定向到文件描述符
< #输入重定向
> #输出重定向
```



### 交互和非交互Shell

交互式：用户输入一个命令会立即返回一个结果

非交互：只执行命令

### 登录和非登录Shell

区别是输不输入账户和密码，并且初始化环境变量流程不一样:

登录：/etc/profile -> /etc/profile.d/*.sh -> /此用户/.bash_profile -> /此用户/.bashrc -> /etc/bahsrc

非登录：/此用户/.bashrc -> /etc/bashrc -> /etc/profile.d/*.sh

注：非登录用户指/etc/passwd/里，带有nologin的就是非登录用户，它们不需要登录就能用shell。使用

```bash
bash
```

切换非登录环境，使用

```bash
$0
```

可以看当前环境是否登录，输出-bash就是登录，bash就是没登录，不能在脚本里用

### 用户的切换

使用

```bash
# 切换用户并且是此用户的登录环境
su 用户名 -l
# 切换用户但是非登录环境
su 用户名
# 切换到当前用户的非登录环境
bash
```

